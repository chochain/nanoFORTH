<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>nanoFORTH: What</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">nanoFORTH
   &#160;<span id="projectnumber">v1.2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('page3.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">What </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>nanoFORTH Operations</h2>
<h3>Internal</h3>
<p>At its core, nanoFORTH is a traditional <b>parse-dispatch virtual machine</b> interpreter with twin stacks. Essentially, it is a parser and a big switch loop. Like every other FORTH, it has dual personallities which toggles between interpreter mode and compiler mode. In interpreter mode, it runs interactively not unlike an old HP hand-held calculator. When in compiler mode, it transcodes user defined functions into <a href="https://www.complang.tuwien.ac.at/forth/threaded-code.html#what" target="_blank">token threaded code</a> which is faster and <b>portable</b>. The later ability enables future units to send data packets as well as instruction code segments to each other. This can bring a big grin but, of course, we later might need to deal with the red flag raised by security concerning parties.</p>
<p>Compared to any FORTH language tutorial, you probably will notice that the length of a word of nanoFORTH, unlike most are 31-character, is 3 characters or less. This departs from standard FORTHs and begs the question of whether nanoFORTH is truly a FORTH. Well, our target platform is a very small MCU and our application has probably a dozen of functions. Aside from easier to type, it has benefit in simplifying some internal handling. The theory says that our brain is pretty good at filling the gap. So, hopefully, with a little bit creativity, our code can be clean and still maintainable. To qualify it as a FORTH or not, probably doesn't matter that much so long as it behaves well, runs fast enough, and useful for our needs.</p>
<h3>Arduino Nano Memory Map</h3>
<p>TODO</p>
<h2>Built-in Words (TODO more)</h2>
<h3>Arithmatics Ops</h3>
<p>+ - * / MOD NEG </p><blockquote class="doxtable">
<p>17 5 + ⏎ </p><blockquote class="doxtable">
<p>22_ok </p>
</blockquote>
</blockquote>
<blockquote class="doxtable">
<p>1 2 3 4 + + + + ⏎ </p><blockquote class="doxtable">
<p>10_ok </p>
</blockquote>
</blockquote>
<blockquote class="doxtable">
<p>10 3 / ⏎ </p><blockquote class="doxtable">
<p>3_ok </p>
</blockquote>
</blockquote>
<h3>Stack Ops</h3>
<p>DRP DUP SWP OVR ROT</p>
<h3>Bit-wise Ops</h3>
<p>AND OR XOR</p>
<h3>Logical Ops</h3>
<p>NOT = &lt; &gt; &lt;= &gt;= &lt;&gt;</p>
<h3>Flow Control (Compiler mode)</h3>
<p>IF ELS THN BGN UTL WHL RPT FOR NXT I </p><blockquote class="doxtable">
<p>f IF...THN<br />
 f IF...ELS...THN<br />
 BGN...RPT<br />
 BGN...f UTL<br />
 BGN...f WHL...RPT<br />
 n1 n2 FOR...NXT </p>
</blockquote>
<h3>Definding Words (Interactive mode)</h3>
<p>: ; VAR CST FGT</p>
<h3>Memory Access</h3>
<p>@ ! C@ C! &gt;R R&gt;</p>
<h3>Console I/O</h3>
<p>KEY EMT CR . ."</p>
<h3>Dictionary</h3>
<p>WRD HRE</p>
<h3>Array</h3>
<p>CEL ALO</p>
<h3>EEPROM Access</h3>
<p>SAV LD</p>
<h3>Arduino</h3>
<p>CLK DLY PIN IN OUT AIN PWM</p>
<h3>32-bit Arithmatic (for Arduino Clock mostly)</h3>
<p>D+ D- DNG </p><blockquote class="doxtable">
<p>CLK 1000 DLY CLK D- DNG ⏎ </p>
</blockquote>
<h3>System, Debug/Tracing</h3>
<p>BYE DMP TRC</p>
<h2>Opcode Formats</h2>
<blockquote class="doxtable">
<p><code>branching : 11BB aaaa aaaa aaaa (12-bit absolute address)</code><br />
 <code>primitive : 10oo oooo (6-bit, i.e. 64 primitives)</code><br />
 <code>3-byte lit: 1011 1111 snnn nnnn nnnn nnnn bf xxxx xxxx (16-bit signed integer)</code><br />
 <code>1-byte lit: 0nnn nnnn (0..127)</code><br />
 <code>n-byte str: len, byte, byte, ... (used in print str)</code><br />
 </p>
</blockquote>
<p><br />
 <a href="page1.html">Review nanoFORTH command examples</a><br />
 <a href="page2.html">Install nanoFORTH</a><br />
 </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
