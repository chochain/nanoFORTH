<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>nanoFORTH: Why</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">nanoFORTH
   &#160;<span id="projectnumber">v1.2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('page1.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Why </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The emerging microcontroller communities are being built no more around specific hardware form factor, but rather around higher level languages. Without introducing an interactive shell like Javascript or microPython supported by ESP or Raspberry, the once popular Arduino platform will gradually lose out the market. However, no matter how the hardware environment evolved, on the edge of IoT universe, a mimimalist system resemble the Aruino UNO will always have its value of existance provided that some of the form-factor might one-day shrunk down to micro or even nano-scale. Being chip argnostic, the Arduino IDE does serve as an excellent learning tool for future systems to come. Factor software develpment time into the mix, an interactive/interpreted language is not only cheaper but more fun than the good old static compiled C code in many cases. Check out <a href="https://www.forth.com/resources/space-applications" target="_blank">NASA</a> and contemplate why FORTH is still running on a number of space probes today.</p>
<p>Following the footstep of <a href="http://middleriver.chagasi.com/electronics/tforth.html" target="_blank">Nakagawa</a> and <a href="https://circuit4us.medium.com/tiny-forth-with-arduino-hardware-support-255f408b745a" target="_blank">circuit4u@medium.com's</a> <b>TinyForth</b>, a light-weight protothreaded FORTH with 3-character keywords for Arduino, I got an idea!</p>
<h2>nanoFORTH - a simple and useful FORTH for Arduino Nano</h2>
<h3>Assumptions</h3>
<ul>
<li>more than 80% of Arduino makers are using UNO or Nano,</li>
<li>most of the makers do not need the full-blown FORTH vocabularies,</li>
<li>most of them are not familer with standard FORTH words, so abbriviation for words is OK,</li>
<li>the meta-compiler is unlikely needed either, i.e. not to create a new type of Forth from within nanoForth,</li>
<li>only a small set of, say 50+, core primitive words are needed for the most of Arduino projects, the rational being anything that requires more elaborated syntax, one might need the power of ESPs.</li>
</ul>
<h3>Requirements</h3>
<ul>
<li>be as simple to use as any example Sketch that comes with the IDE (no bootloader burning),</li>
<li>provide a REPL development/operating environment for Arduino,</li>
<li>provide core Arduino functions (i.g. pinMode, digitalRead,Write, analogRead,Write, millis, delay),</li>
<li>provide hardware thread(s) in addition to nanoFORTH thread so new components can be added (ig. Bluetooth),</li>
<li>provide an Arduino library that developers can include easily,</li>
<li>provide at least 1K RAM dictionary for resonablly size of work,</li>
<li>provide EEPROM persisted storage for new words which can be automatically reloaded on next start-up,</li>
<li>optionally show byte-code stream while assembled to help beginers understand FORTH internal,</li>
<li>optionally show execution tracing to help debugging, also provision for single-stepping.</li>
</ul>
<h3>Use Cases - Interaction Examples</h3>
<ul>
<li>turn on LED(red) on digital pin 5, imagine you have that, (1 is HIGH) <blockquote class="doxtable">
<p>1 5 OUT ⏎ </p><table class="doxtable">
<tr>
<th align="left"></th></tr>
<tr>
<td align="left"><div class="image">
<img src="nanoforth_led_red.jpg" alt="nanoforth_led_red.jpg" width="200px"/>
</div>
 </td></tr>
</table>
</blockquote>
<br />
</li>
<li>turn off LED(blue) on digital pin 6, also imagine, too (0 is LOW) <blockquote class="doxtable">
<p>0 6 OUT ⏎ </p>
</blockquote>
</li>
<li>define a function, or a 'word' in FORTH, <b>red</b> to turn red LED on, and blue LED off <blockquote class="doxtable">
<p>: <b>red</b> 1 5 OUT 0 6 OUT ; ⏎ </p>
</blockquote>
</li>
<li>define a word <b>blu</b> to turn red LED off and turn blue LED on (sorry, no blue, nanoFORTH takes max 3 characters only) <blockquote class="doxtable">
<p>: <b>blu</b> 0 5 OUT 1 6 OUT ; ⏎ </p>
</blockquote>
</li>
<li>execute <b>blu</b>, i.e. to turn red LED off, and blue LED on <blockquote class="doxtable">
<p><b>blu</b> ⏎ </p>
</blockquote>
</li>
<li>define a word <b>xy</b> to blink red/blue every 500 ms alternatively <blockquote class="doxtable">
<p>: <b>xy</b> 0 FOR <b>red</b> 500 DLY <b>blu</b> 500 DLY NXT ; ⏎ </p>
</blockquote>
</li>
<li>run 10 cycles of <b>xy</b> <blockquote class="doxtable">
<p>10 <b>xy</b> ⏎ </p><table class="doxtable">
<tr>
<th align="left"></th></tr>
<tr>
<td align="left"> <iframe width="400" height="320" src="https://www.youtube.com/embed/trmDNh41-pQ?version=3&playlist=trmDNh41-pQ&loop=1&controls=0" title="" frameborder="0" allow="autoplay; picture-in-picture" allowfullscreen></iframe>  </td></tr>
</table>
</blockquote>
<br />
</li>
<li>a bit too slow! nanoFORTH lets you redefine <b>xy</b> by "forget" it first <blockquote class="doxtable">
<p>FGT <b>xy</b> ⏎<br />
 : <b>xy</b> 0 FOR <b>red</b> 200 DLY <b>blu</b> 300 DLY I . NXT ; ⏎<br />
 </p><blockquote class="doxtable">
<p>&gt; so, you probably found out that <b>I</b> is the counter and . (dot) prints it,<br />
 &gt; also, 10 0 FOR ... NXT is to loop 10 times, i.e. counter from 0, 1, 2, ..., 9 </p>
</blockquote>
</blockquote>
</li>
<li>now try 20 cycles of <b>xy</b> this time <blockquote class="doxtable">
<p>20 <b>xy</b> ⏎ </p>
</blockquote>
</li>
<li>let's read analog pin 1 (photoresister value 0~1023), imagine again <blockquote class="doxtable">
<p>1 AIN ⏎<br />
 258_ok </p>
</blockquote>
</li>
<li>define <b>lit</b> to read from photoresister and determine whether its value is &gt; 200 <blockquote class="doxtable">
<p>: <b>lit</b> 1 AIN 200 &gt; ; ⏎ </p>
</blockquote>
</li>
<li>execute <b>lit</b>, return value 1 on stack (FORTH's memory) if it's bright enough, 0 if not <blockquote class="doxtable">
<p><b>lit</b> ⏎<br />
 1_ok </p>
</blockquote>
</li>
<li>define <b>?Z</b> that turns on red or blue depends on input value on stack. unlike other languages, you can create really strange function names <blockquote class="doxtable">
<p>: <b>?Z</b> IF <b>red</b> ELS <b>blu</b> THN ; ⏎ </p>
</blockquote>
</li>
<li>run <b>?Z</b> which take input from stack, 1 turns on red or 0 turn on blue <blockquote class="doxtable">
<p>1 <b>?Z</b> ⏎<br />
 0 <b>?Z</b> ⏎ </p>
</blockquote>
</li>
<li>now we can turn on red or blue LED depends on lighting condition (try blocking the photoresister), <b>lit</b> leave 1 or 0 on stack, <b>?Z</b> takes the value and turns on red or blue <blockquote class="doxtable">
<p><b>lit</b> <b>?Z</b> ⏎ </p>
</blockquote>
</li>
<li>define a loop, blocking the photoresister and see it toggles between blue and red LEDs. <blockquote class="doxtable">
<p>: <b>xyz</b> 0 FOR <b>lit</b> <b>?Z</b> 1000 DLY NXT ; ⏎<br />
 60 <b>xyz</b> </p><blockquote class="doxtable">
<p>&gt; Can this become a trigger i.e. mouse trap or something useful?<br />
 &gt; Make it run in an infinite loop like a web-server? Sure, but we will leave that detail to future chapter.<br />
 &gt; Have you notice the Pin 13 green LED is blinking at its own pace? </p>
</blockquote>
</blockquote>
</li>
<li>show all nanoFORTH words available, including <b>?Z</b>, <b>xy</b>, <b>lit</b>, <b>blu</b>, <b>red</b> that we've just created <blockquote class="doxtable">
<p>WRD ⏎ </p><table class="doxtable">
<tr>
<th align="left"></th></tr>
<tr>
<td align="left"><div class="image">
<img src="nanoforth_wrd_list.png" alt="nanoforth_wrd_list.png" width="800px"/>
</div>
 </td></tr>
</table>
<blockquote class="doxtable">
<p>&gt; Only a short list of 'words', thus it does not take much to master. </p>
</blockquote>
</blockquote>
<br />
</li>
</ul>
<p>OK, if that captured the imaginations, we might have an idea of what nanoFORTH is trying to do. Remember, we do these without any compilation but, instead, "talk" directly with Arduino once nanoFORTH uploaded via the USB cable. The interactive nature changes the way we are so used to. Further more, what if we can do it via WiFi or BLE? Look Mom! I can talk to the mailbox. No cable!</p>
<p><br />
 <a href="page2.html">Ready to get nanoFORTH for a trial?</a><br />
 <a href="page3.html">References and all the details...</a> </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
